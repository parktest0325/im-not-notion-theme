{{ define "main" }}
<div class="guestbook-page">
  <div class="guestbook-inner">
    <header class="guestbook-header">
      <h1 class="section-title-glitch" data-text="Guestbook">Guestbook</h1>
      <p class="guestbook-desc">{{ .Description | default "Leave a message â€” sign in with GitHub to comment." }}</p>
    </header>

    {{ with .Site.Params.giscus }}
    {{ if and .repo .repoId .categoryId }}
    <div class="guestbook-comments">
      <div class="giscus-container"></div>
      <script>
        (function() {
          var theme = document.documentElement.dataset.theme === 'dark' ? 'dark' : 'light';
          var s = document.createElement('script');
          s.src = 'https://giscus.app/client.js';
          s.setAttribute('data-repo', '{{ .repo }}');
          s.setAttribute('data-repo-id', '{{ .repoId }}');
          s.setAttribute('data-category', '{{ .category | default "Announcements" }}');
          s.setAttribute('data-category-id', '{{ .categoryId }}');
          s.setAttribute('data-mapping', 'specific');
          s.setAttribute('data-term', 'guestbook');
          s.setAttribute('data-strict', '0');
          s.setAttribute('data-reactions-enabled', '1');
          s.setAttribute('data-emit-metadata', '0');
          s.setAttribute('data-input-position', 'top');
          s.setAttribute('data-theme', theme);
          s.setAttribute('data-lang', '{{ .lang | default "ko" }}');
          s.setAttribute('data-loading', 'lazy');
          s.setAttribute('crossorigin', 'anonymous');
          s.async = true;
          document.querySelector('.guestbook-comments .giscus-container').appendChild(s);
        })();
      </script>
    </div>
    {{ else }}
    <p class="guestbook-notice">Giscus is not configured. Set <code>[params.giscus]</code> in hugo.toml with <code>repo</code>, <code>repoId</code>, and <code>categoryId</code>.</p>
    {{ end }}
    {{ else }}
    <p class="guestbook-notice">Giscus is not configured. Set <code>[params.giscus]</code> in hugo.toml.</p>
    {{ end }}
  </div>
</div>
{{ end }}
